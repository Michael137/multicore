1. more robust threadId generation and indexing
2. More generic compat barrier
3. Remove GCC sanitizer noise (not a problem on Clang)
